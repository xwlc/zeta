#!/usr/bin/env node
// SPDX-License-Identifier: GPL-3.0-only OR Apache-2.0 OR MIT
// SPDX-FileCopyrightText: 2024 Charles Wong <charlie-wong@outlook.com>
// Created By: Charles Wong 2024-07-05T02:34:53+08:00 Asia/Shanghai
// Repository: git@gitlab.com:xwlc/zeta
// Minify JS Online => https://minify-js.com
class ZLog{static _instance_=null;static RTME={};static{if("object"==typeof process){this.RTME.nodejs=!0,this.RTME.supports={nocolor:!1,ansi:!0,ansi256:!1,truecolor:!1};const r=require("tty"),s=require("process");if(r.isatty(1)&&r.isatty(2)){function t(r){const t=r.startsWith("-")?"":1===r.length?"-":"--",o=s.argv.indexOf(t+r),e=s.argv.indexOf("--");return-1!==o&&(-1===e||o<e)}if(t("no-color")||t("no-colors")||t("color=false")||t("color=never"))this.RTME.supports.ansi=!1,this.RTME.supports.nocolor=!0;else if(("xterm-kitty"===s.env.TERM||"truecolor"===s.env.COLORTERM||t("color=16m")||t("color=full")||t("color=truecolor"))&&(this.RTME.supports.truecolor=!0),(t("color=256")||/-256(color)?$/i.test(s.env.TERM))&&(this.RTME.supports.ansi256=!0),"CI"in s.env&&("GITHUB_ACTIONS"in s.env||"GITEA_ACTIONS"in s.env)&&(this.RTME.supports.truecolor=!0),"win32"===s.platform){const o=require("os").release().split(".");Number(o[0])>=10&&Number(o[2])>=10586&&(Number(o[2])>=14931?this.RTME.supports.truecolor=!0:this.RTME.supports.ansi256=!0)}}else this.RTME.supports.ansi=!1,this.RTME.supports.nocolor=!0}else this.RTME.browser=!0,this.RTME.supports={nocolor:!1,ansi:!0,ansi256:!0,truecolor:!0}}static CODE={};static ANSI={attrs:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],blink:[5,25],inverse:[7,27],hidden:[8,28],strikethrough:[9,29],overline:[53,55]},color:{fg:{black:{normal:[30,39],bright:[90,39]},red:{normal:[31,39],bright:[91,39]},green:{normal:[32,39],bright:[92,39]},yellow:{normal:[33,39],bright:[93,39]},blue:{normal:[34,39],bright:[94,39]},purple:{normal:[35,39],bright:[95,39]},cyan:{normal:[36,39],bright:[96,39]},white:{normal:[37,39],bright:[97,39]},gray:{bright:[2,39],normal:[90,39]},grey:{bright:[2,39],normal:[90,39]}},bg:{black:{normal:[40,49],bright:[100,49]},red:{normal:[41,49],bright:[101,49]},green:{normal:[42,49],bright:[102,49]},yellow:{normal:[43,49],bright:[103,49]},blue:{normal:[44,49],bright:[104,49]},purple:{normal:[45,49],bright:[105,49]},cyan:{normal:[46,49],bright:[106,49]},white:{normal:[47,49],bright:[107,49]},gray:{bright:[2,49],normal:[100,49]},grey:{bright:[2,49],normal:[100,49]}}}};static{const r=(r=0)=>(s,t,o="")=>`[0m[${o}${38+r};5;${t}m`+s+"[0m",s=(r=0)=>(s,t,o,e,i="")=>`[0m[${i}${38+r};2;${t};${o};${e}m`+s+"[0m";this.CODE.ansi256FG=r(),this.CODE.ansi256BG=r(10),this.CODE.ansi16mFG=s(),this.CODE.ansi16mBG=s(10),this.CODE.ansiColor=(r,s,t="")=>`[0m[${t}${s}m`+r+"[0m"}static cssNamedColorToHex(r){const s=ZLog.CssNamedColor[r];return s||[0,0,0]}static CssNamedColor={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};static ansi256ToAnsi16(r){if(r<8)return 30+r;if(r<16)return 90+r-8;let s,t,o;if(r>=232)s=(10*(r-232)+8)/255,t=s,o=s;else{const e=(r-=16)%36;s=Math.floor(r/36)/5,t=Math.floor(e/6)/5,o=e%6/5}const e=2*Math.max(s,t,o);if(0===e)return 30;let i=30+(Math.round(o)<<2|Math.round(t)<<1|Math.round(s));return 2===e&&(i+=60),i}static rgbToAnsi16(r,s,t){return ZLog.ansi256ToAnsi16(ZLog.rgbToAnsi256(r,s,t))}static rgbToAnsi256(r,s,t){return r===s&&s===t?r<8?16:r>248?231:Math.round((r-8)/247*24)+232:16+36*Math.round(r/255*5)+6*Math.round(s/255*5)+Math.round(t/255*5)}static hexToAnsi16(r){return ZLog.ansi256ToAnsi16(ZLog.hexToAnsi256(r))}static hexToAnsi256(r){return ZLog.rgbToAnsi256(...ZLog.hexToRgb(r))}static hexToRgb(r){let s,t,o,e;if(/^#([a-f\d]{6})$/i.exec(r.toString(16))?[,s]=/^#([a-f\d]{6})$/i.exec(r.toString(16)):/^#([a-f\d]{3})$/i.exec(r.toString(16))?[,s]=/^#([a-f\d]{3})$/i.exec(r.toString(16)):/^([a-f\d]{6})$/i.exec(r.toString(16))?[s]=/^([a-f\d]{6})$/i.exec(r.toString(16)):/^([a-f\d]{3})$/i.exec(r.toString(16))&&([s]=/^([a-f\d]{3})$/i.exec(r.toString(16))),3===s.length)t=s.substring(0,1),o=s.substring(1,2),e=s.substring(2,3);else{if(6!==s.length)return[0,0,0];t=s.substring(0,2),o=s.substring(2,4),e=s.substring(4,6)}return[Number.parseInt("0x"+t),Number.parseInt("0x"+o),Number.parseInt("0x"+e)]}_setDefaultValues(){if(this.mode.trace=!1,ZLog.RTME.supports.nocolor)return!0;this.color.key=null,this.color.use={ansi256:0,rgb:[0,0,0],css:"black",html:"#000000"},this.ansi.fg=!0,this.ansi.normal=!0,this.ansi.bg=!1,this.ansi.bright=!1;for(const r of Object.keys(ZLog.ANSI.attrs))this.ansi.attrs[r]=!1}_attrsCodes(){let r="";for(const s of Object.keys(ZLog.ANSI.attrs))this.ansi.attrs[s]&&(r+=ZLog.ANSI.attrs[s][0]+";");return r}attrs(r=[]){if(ZLog.RTME.supports.nocolor)return this;for(let s of r)ZLog.ANSI.attrs[s]?this.ansi.attrs[s]=!0:this.ansi.attrs[s]=!1;return this}fg(r=!0){return ZLog.RTME.supports.nocolor||(this.ansi.fg=!!r),this}bg(r=!0){return ZLog.RTME.supports.nocolor||(this.ansi.bg=!!r),this}normal(r=!0){return ZLog.RTME.supports.nocolor||(r?(this.ansi.normal=!0,this.ansi.bright=!1):(this.ansi.normal=!1,this.ansi.bright=!0)),this}bright(r=!0){return ZLog.RTME.supports.nocolor||(r?(this.ansi.normal=!1,this.ansi.bright=!0):(this.ansi.normal=!0,this.ansi.bright=!1)),this}ansi256(r){return!ZLog.RTME.supports.nocolor&&ZLog.RTME.supports.ansi256&&Number.isInteger(r)?((r=Number.parseInt(r))>=0&&r<=255?(this.color.key="ansi256",this.color.use.ansi256=r):(this.color.key=null,this.color.use.ansi256=0),this):(this.color.key=null,this.color.use.ansi256=0,this)}rgb(r,s,t){return!ZLog.RTME.supports.nocolor&&ZLog.RTME.supports.truecolor&&Number.isInteger(r)&&Number.isInteger(s)&&Number.isInteger(t)?(r=Number.parseInt(r),s=Number.parseInt(s),t=Number.parseInt(t),r>=0&&r<=255&&s>=0&&s<=255&&t>=0&&t<=255?(this.color.key="rgb",this.color.use.rgb=[r,s,t]):(this.color.key=null,this.color.use.rgb=[0,0,0]),this):(this.color.key=null,this.color.use.rgb=[0,0,0],this)}html(r){return ZLog.RTME.supports.nocolor?(this.color.key=null,this.color.use.html="#000000",this):(/^#[a-f\d]{6}$/i.test(r)||/^#[a-f\d]{3}$/i.test(r)?(this.color.key="html",this.color.use.html=r,ZLog.RTME.supports.truecolor&&this.rgb(...ZLog.hexToRgb(r))):(this.color.key=null,this.color.use.html="#000000"),this)}css(r){return ZLog.RTME.supports.nocolor?(this.color.key=null,this.color.use.css="",this):(ZLog.CssNamedColor[r]?(this.color.key="css",this.color.use.css=r,ZLog.RTME.supports.truecolor&&this.rgb(...ZLog.CssNamedColor[r])):(this.color.key=null,this.color.use.css=""),this)}words(r){if(ZLog.RTME.supports.nocolor||"string"!=typeof r||!r||!this.color.key||void 0===this.color.use[this.color.key])return this._setDefaultValues(),r;let s;if("rgb"===this.color.key)if(ZLog.RTME.supports.truecolor){const t=this.color.use.rgb;s=this.ansi.bg?ZLog.CODE.ansi16mBG(r,...t,this._attrsCodes()):ZLog.CODE.ansi16mFG(r,...t,this._attrsCodes())}else if(ZLog.RTME.supports.ansi256){const t=ZLog.rgbToAnsi256(...this.color.use.rgb);s=this.ansi.bg?ZLog.CODE.ansi256BG(r,t,this._attrsCodes()):ZLog.CODE.ansi256FG(r,t,this._attrsCodes())}else{const t=ZLog.rgbToAnsi16(...this.color.use.rgb);s=ZLog.CODE.ansiColor(r,t,this._attrsCodes())}else if("ansi256"===this.color.key)if(ZLog.RTME.supports.ansi256){const t=this.color.use.ansi256;s=this.ansi.bg?ZLog.CODE.ansi256BG(r,t,this._attrsCodes()):ZLog.CODE.ansi256FG(r,t,this._attrsCodes())}else{const t=ZLog.ansi256ToAnsi16(this.color.use.ansi256);s=ZLog.CODE.ansiColor(r,t,this._attrsCodes())}else s=r;return this._setDefaultValues(),s}constructor(){if(ZLog._instance_)return ZLog._instance_;this.mode={},this.ansi={},this.color={},this.ansi.attrs={},this._setDefaultValues();for(const r of Object.keys(ZLog.ANSI.color.fg))this[r]=function(s){if(this.mode.trace&&console.trace(),ZLog.RTME.supports.nocolor)return s;if("string"!=typeof s||!s)return this._setDefaultValues(),s;let t,o=0,e="normal";return this.ansi.normal&&(e="normal"),this.ansi.bright&&(e="bright"),o=this.ansi.bg?ZLog.ANSI.color.bg[r][e][0]:ZLog.ANSI.color.fg[r][e][0],t=ZLog.CODE.ansiColor(s,o,this._attrsCodes()),this._setDefaultValues(),t};ZLog._instance_=this}trace(r=!0){return this.mode.trace=!!r,this}}const zlog=new ZLog;
